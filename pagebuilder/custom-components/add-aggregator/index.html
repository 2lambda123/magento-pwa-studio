<!DOCTYPE html>
<html lang="" dir="ltr" class="spectrum spectrum--medium spectrum--lightest">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">

  
  <meta http-equiv="refresh" content="0;URL='https://developer.adobe.com/commerce/pwa-studio/integrations/pagebuilder/custom-components/add-aggregator/'" />
  

  <title>Add aggregator | Magento PWA Documentation</title>
  <meta name="description" content="Everything you need to build a Magento PWA.">

  <link rel="stylesheet" href="https://use.typekit.net/iaw1apr.css">
  <link rel="stylesheet" href="/pwa-studio/assets/css/app.css?ver=14" />
  <link rel="stylesheet" href="/pwa-studio/assets/css/print.css?ver=14" media="print" />
  <script src="//assets.adobedtm.com/a7d65461e54e/f87b70cb627a/launch-b042bff6c581.min.js" async></script>

  <link rel="stylesheet" href="/pwa-studio/builds/css/main.css" />

<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

  <script>
  var baseUrl = "/pwa-studio";
  var algolia = {
    id : "E642SEDTHL",
    index: "pwa-devdocs",
    key: "d2d0f33ab73e291ef8d88d8b565e754c"
  };

  var indices = [
    {
      label: "PWA",
      name: "pwa-devdocs",
      baseUrl: "https://pwastudio.io"
    },
    {
      label: "DevDocs",
      name: "devdocs",
      facets: [["guide_version: 2.3", "versionless: true"]],
      refinements: [
        {
          label: "Functional areas",
          attribute: "functional_areas"
        }
      ],
      baseUrl: "https://devdocs.magento.com"
    },
    {
      label: "Commerce User Guide",
      name: "merchdocs",
      baseUrl: "https://docs.magento.com/user-guide"
    },
    {
      label: "MBI User Guide",
      name: "merchdocs-mbi",
      baseUrl: "https://docs.magento.com/mbi"
    },
    {
      label: "Order Management",
      name: "oms-en",
      baseUrl: "https://omsdocs.magento.com"
    }
  ];
</script>



<!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
  new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
  j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
  'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
  })(window,document,'script','dataLayer','GTM-KRCLXBB');</script>
<!-- End Google Tag Manager -->




  <link rel="shortcut icon" type="image/vnd.microsoft.icon" href="https://magento.com/favicon.ico">
  <link rel="apple-touch-icon" type="image/png" href="https://magento.com/apple-touch-icon.png">
  <link rel="apple-touch-icon" type="image/png" sizes="57x57" href="https://magento.com/apple-touch-icon-57x57.png">
  <link rel="apple-touch-icon" type="image/png" sizes="72x72" href="https://magento.com/apple-touch-icon-72x72.png">
  <link rel="apple-touch-icon" type="image/png" sizes="76x76" href="https://magento.com/apple-touch-icon-76x76.png">
  <link rel="apple-touch-icon" type="image/png" sizes="114x114" href="https://magento.com/apple-touch-icon-114x114.png">
  <link rel="apple-touch-icon" type="image/png" sizes="120x120" href="https://magento.com/apple-touch-icon-120x120.png">
  <link rel="apple-touch-icon" type="image/png" sizes="144x144" href="https://magento.com/apple-touch-icon-144x144.png">
  <link rel="apple-touch-icon" type="image/png" sizes="152x152" href="https://magento.com/apple-touch-icon-152x152.png">
  <link rel="apple-touch-icon" type="image/png" sizes="180x180" href="https://magento.com/apple-touch-icon-180x180.png">

</head>

<body class="layout-default">

  <header class="site-header">

    <nav class="site-nav">

  <div class="nav-container">

    <div class="menu-btn">
      <button id="menu-btn" class="menu-trigger menu-icon" aria-haspopup="true" aria-controls="nav-main" aria-label="Menu"></button>
    </div>

    <a class="logo" data-proofer-ignore href="/pwa-studio/">
      <img class="logo-image" src="/pwa-studio/assets/i/adobe-a.svg" alt="Adobe">
      <span class="logo-text">Adobe</span>
      <span class="site-logo">Magento PWA Docs</span>
    </a>

    <div id="nav-main" class="nav-main-wrap" aria-labelledby="menu-btn">
      <!-- Main Navigation -->
<ul class="nav-main spectrum-Tabs spectrum-Tabs--horizontal" role="menubar">

  
  <li class="nav-main-item spectrum-Tabs-item" tabindex="0" role="menuitem" aria-haspopup="true">
    <span class="spectrum-Tabs-itemLabel" tabindex="-1">Overview</span>
    <div class="nav-popup spectrum-Popover">
      <ul class="spectrum-Menu">
        
        <li class="spectrum-Menu-item" role="menuitem">
          <a class="spectrum-Menu-itemLabel" href="/pwa-studio/technologies/overview/">PWA Studio overview</a>
        </li> 
        
        <li class="spectrum-Menu-item" role="menuitem">
          <a class="spectrum-Menu-itemLabel" href="/pwa-studio/frequently-asked-questions/">Frequently Asked Questions</a>
        </li> 
        
        <li class="spectrum-Menu-item" role="menuitem">
          <a class="spectrum-Menu-itemLabel" href="/pwa-studio/technologies/storefront-architecture/">Storefront architecture</a>
        </li> 
        
        <li class="spectrum-Menu-item" role="menuitem">
          <a class="spectrum-Menu-itemLabel" href="/pwa-studio/technologies/basic-concepts/">Basic concepts</a>
        </li> 
        
        <li class="spectrum-Menu-item" role="menuitem">
          <a class="spectrum-Menu-itemLabel" href="/pwa-studio/pwa-buildpack/">PWA Buildpack</a>
        </li> 
        
        <li class="spectrum-Menu-item" role="menuitem">
          <a class="spectrum-Menu-itemLabel" href="/pwa-studio/peregrine/">Peregrine</a>
        </li> 
        
        <li class="spectrum-Menu-item" role="menuitem">
          <a class="spectrum-Menu-itemLabel" href="/pwa-studio/venia-pwa-concept/">Venia storefront concept</a>
        </li> 
        
        <li class="spectrum-Menu-item" role="menuitem">
          <a class="spectrum-Menu-itemLabel" href="/pwa-studio/technologies/upward/">UPWARD</a>
        </li> 
        
      </ul>
    </div>
  </li>

  

  
  <li class="menuitem spectrum-Tabs-item ">
    <a class="spectrum-Tabs-itemLabel" href="/pwa-studio/tutorials/">Tutorials</a>
  </li>
  

  
  <li class="nav-main-item spectrum-Tabs-item" tabindex="0" role="menuitem" aria-haspopup="true">
    <span class="spectrum-Tabs-itemLabel" tabindex="-1">API Reference</span>
    <div class="nav-popup spectrum-Popover">
      <ul class="spectrum-Menu">
        
        <li class="spectrum-Menu-item" role="menuitem">
          <a class="spectrum-Menu-itemLabel" href="/pwa-studio/pwa-buildpack/reference/buildpack-cli/">PWA Buildpack</a>
        </li> 
        
        <li class="spectrum-Menu-item" role="menuitem">
          <a class="spectrum-Menu-itemLabel" href="/pwa-studio/peregrine/reference/targets/">Peregrine API</a>
        </li> 
        
        <li class="spectrum-Menu-item" role="menuitem">
          <a class="spectrum-Menu-itemLabel" href="/pwa-studio/venia-ui/reference/targets/">Venia UI API</a>
        </li> 
        
      </ul>
    </div>
  </li>

  

  
  <li class="nav-main-item spectrum-Tabs-item" tabindex="0" role="menuitem" aria-haspopup="true">
    <span class="spectrum-Tabs-itemLabel" tabindex="-1">Integrations</span>
    <div class="nav-popup spectrum-Popover">
      <ul class="spectrum-Menu">
        
        <li class="spectrum-Menu-item" role="menuitem">
          <a class="spectrum-Menu-itemLabel" href="/pwa-studio/pagebuilder/">Page Builder</a>
        </li> 
        
        <li class="spectrum-Menu-item" role="menuitem">
          <a class="spectrum-Menu-itemLabel" href="/pwa-studio/product-recs/">Product Recommendations</a>
        </li> 
        
      </ul>
    </div>
  </li>

  

</ul>

    </div>

    <div class="nav-actions">
        
        

        <div class="app-switcher">
  <div class="dropdown">
    <button id="app-switcher-trigger" class="app-switcher-trigger" data-toggle="dropdown" aria-haspopup="true"
      aria-expanded="false" aria-label="Documentation sites"></button>
    <div class="dropdown-menu spectrum-Popover spectrum-Dropdown-popover spectrum-Popover--bottom dropdown-menu-right"
      aria-labelledby="app-switcher-trigger" role="menu">
      <div class="app-switcher-content">
        
        <div class="spectrum-Menu app-switcher-group">
          <span class="spectrum-Menu-sectionHeading"
            id="app-switcher-category-1">Developer</span>
          <ul class="spectrum-Menu" role="group" aria-labelledby="app-switcher-category-1">
            
            <li class="spectrum-Menu-item" role="menuitem"><a class="spectrum-Menu-itemLabel"
                href="https://devdocs.magento.com/?itm_source=pwa-devdocs&itm_medium=top_nav&itm_campaign=app_switcher&itm_term=Commerce Developer Guide">Commerce Developer Guide</a>
            </li>
            
            <li class="spectrum-Menu-item" role="menuitem"><a class="spectrum-Menu-itemLabel"
                href="http://pwastudio.io/?itm_source=pwa-devdocs&itm_medium=top_nav&itm_campaign=app_switcher&itm_term=PWA Studio">PWA Studio</a>
            </li>
            
            <li class="spectrum-Menu-item" role="menuitem"><a class="spectrum-Menu-itemLabel"
                href="https://omsdocs.magento.com/?itm_source=pwa-devdocs&itm_medium=top_nav&itm_campaign=app_switcher&itm_term=Order Management">Order Management</a>
            </li>
            
          </ul>
        </div>
        
        <div class="spectrum-Menu app-switcher-group">
          <span class="spectrum-Menu-sectionHeading"
            id="app-switcher-category-2">Merchant</span>
          <ul class="spectrum-Menu" role="group" aria-labelledby="app-switcher-category-2">
            
            <li class="spectrum-Menu-item" role="menuitem"><a class="spectrum-Menu-itemLabel"
                href="https://docs.magento.com/user-guide/?itm_source=pwa-devdocs&itm_medium=top_nav&itm_campaign=app_switcher&itm_term=Commerce User Guide">Commerce User Guide</a>
            </li>
            
            <li class="spectrum-Menu-item" role="menuitem"><a class="spectrum-Menu-itemLabel"
                href="https://omsdocs.magento.com/userguides/?itm_source=pwa-devdocs&itm_medium=top_nav&itm_campaign=app_switcher&itm_term=Order Management">Order Management</a>
            </li>
            
            <li class="spectrum-Menu-item" role="menuitem"><a class="spectrum-Menu-itemLabel"
                href="https://docs.magento.com/mbi/?itm_source=pwa-devdocs&itm_medium=top_nav&itm_campaign=app_switcher&itm_term=Commerce Reporting">Commerce Reporting</a>
            </li>
            
          </ul>
        </div>
        
      </div>
    </div>
  </div>
</div>


        <div class="search-btn">
  <button class="search-trigger" aria-label="Search">
    <svg class="spectrum-Icon" focusable="false" aria-hidden="true" aria-label="Search">
      <rect opacity="0" width="18" height="18" /><path class="a" d="M16.5865,15.107,12.7,11.2215A6.413,6.413,0,1,0,11.2215,12.7l3.886,3.886a1.05,1.05,0,0,0,1.479-1.479ZM3,7.5A4.5,4.5,0,1,1,7.5,12,4.5,4.5,0,0,1,3,7.5Z" />
    </svg>
  </button>
</div>

<div class="quick-search">
  <form class="spectrum-Search spectrum-Textfield search-form" action="/pwa-studio/search/">
  <input type="search" placeholder="Looking for something specific?" name="query" value=""
    class="spectrum-Textfield-input spectrum-Search-input search-field form-control" autocomplete="off">
  <svg class="spectrum-Icon spectrum-UIIcon-Magnifier spectrum-Search-icon" focusable="false" aria-hidden="true">
    <rect fill="#ff13dc" opacity="0" width="18" height="18" />
    <path class="a"
      d="M16.5865,15.107,12.7,11.2215A6.413,6.413,0,1,0,11.2215,12.7l3.886,3.886a1.05,1.05,0,0,0,1.479-1.479ZM3,7.5A4.5,4.5,0,1,1,7.5,12,4.5,4.5,0,0,1,3,7.5Z" />
  </svg>
  <button type="reset" class="spectrum-ClearButton spectrum-Search-clearButton">
    <svg class="spectrum-Icon spectrum-UIIcon-Cross75" focusable="false" aria-hidden="true">
      <rect fill="#ff13dc" opacity="0" width="18" height="18" />
      <path class="a"
        d="M13.2425,3.343,9,7.586,4.7575,3.343a.5.5,0,0,0-.707,0L3.343,4.05a.5.5,0,0,0,0,.707L7.586,9,3.343,13.2425a.5.5,0,0,0,0,.707l.707.7075a.5.5,0,0,0,.707,0L9,10.414l4.2425,4.243a.5.5,0,0,0,.707,0l.7075-.707a.5.5,0,0,0,0-.707L10.414,9l4.243-4.2425a.5.5,0,0,0,0-.707L13.95,3.343a.5.5,0,0,0-.70711-.00039Z" />
    </svg>
  </button>
</form>

</div>

    </div>

  </div>
</nav><!-- .site-nav -->
<div class="nav-main-fader"></div>


  </header>

  <div class="global-wrapper">

    

    <div class="main-container">
      <a id="main-content"></a>


<div class="content-container">

	<!-- sidebar -->
<aside class="sidebar">
    <button class="toc-toggler">Table of Contents</button>
    <div class="sidebar-wrapper">

      






<div class="menu-section">
    <div class="toc-entry">
        <h4 class="guide-title">Page Builder</h4>
    </div>

    <ul class="table-of-contents spectrum-SideNav spectrum-SideNav--multiLevel" >
    
        <li class="spectrum-SideNav-item ">
            
            <a href="/pwa-studio/pagebuilder/" class="spectrum-SideNav-itemLink  ">Integration</a>
            

            
        </li>
    
        <li class="spectrum-SideNav-item ">
            
            <a href="/pwa-studio/pagebuilder/known-limitations/" class="spectrum-SideNav-itemLink  ">Known limitations</a>
            

            
        </li>
    
        <li class="spectrum-SideNav-item ">
            
            <span class="spectrum-SideNav-itemLink">Creating custom components</span>
            

            
            <ul class="spectrum-SideNav">
            
                <li class="spectrum-SideNav-item ">
                    
                    <a href="/pwa-studio/pagebuilder/custom-components/overview/" class="spectrum-SideNav-itemLink  ">Overview</a>
                    
                </li>
            
                <li class="spectrum-SideNav-item ">
                    
                    <a href="/pwa-studio/pagebuilder/custom-components/setup-component/" class="spectrum-SideNav-itemLink  ">Set up component</a>
                    
                </li>
            
                <li class="spectrum-SideNav-item is-selected">
                    
                    <a href="/pwa-studio/pagebuilder/custom-components/add-aggregator/" class="spectrum-SideNav-itemLink  ">Add aggregator</a>
                    
                </li>
            
                <li class="spectrum-SideNav-item ">
                    
                    <a href="/pwa-studio/pagebuilder/custom-components/add-stylesheet/" class="spectrum-SideNav-itemLink  ">Add stylesheet</a>
                    
                </li>
            
                <li class="spectrum-SideNav-item ">
                    
                    <a href="/pwa-studio/pagebuilder/custom-components/add-component/" class="spectrum-SideNav-itemLink  ">Add component</a>
                    
                </li>
            
                <li class="spectrum-SideNav-item ">
                    
                    <a href="/pwa-studio/pagebuilder/custom-components/debugging/" class="spectrum-SideNav-itemLink  ">Debugging tips</a>
                    
                </li>
            
            </ul>
            
        </li>
    
        <li class="spectrum-SideNav-item ">
            
            <a href="/pwa-studio/pagebuilder/utility-functions/" class="spectrum-SideNav-itemLink  ">Utility functions</a>
            

            
        </li>
    
        <li class="spectrum-SideNav-item ">
            
            <span class="spectrum-SideNav-itemLink">Components</span>
            

            
            <ul class="spectrum-SideNav">
            
                <li class="spectrum-SideNav-item ">
                    
                    <a href="/pwa-studio/pagebuilder/components/banner/" class="spectrum-SideNav-itemLink  ">Banner</a>
                    
                </li>
            
                <li class="spectrum-SideNav-item ">
                    
                    <a href="/pwa-studio/pagebuilder/components/block/" class="spectrum-SideNav-itemLink  ">Block</a>
                    
                </li>
            
                <li class="spectrum-SideNav-item ">
                    
                    <a href="/pwa-studio/pagebuilder/components/buttons/" class="spectrum-SideNav-itemLink  ">Buttons</a>
                    
                </li>
            
                <li class="spectrum-SideNav-item ">
                    
                    <a href="/pwa-studio/pagebuilder/components/column/" class="spectrum-SideNav-itemLink  ">Column</a>
                    
                </li>
            
                <li class="spectrum-SideNav-item ">
                    
                    <a href="/pwa-studio/pagebuilder/components/divider/" class="spectrum-SideNav-itemLink  ">Divider</a>
                    
                </li>
            
                <li class="spectrum-SideNav-item ">
                    
                    <a href="/pwa-studio/pagebuilder/components/heading/" class="spectrum-SideNav-itemLink  ">Heading</a>
                    
                </li>
            
                <li class="spectrum-SideNav-item ">
                    
                    <a href="/pwa-studio/pagebuilder/components/html/" class="spectrum-SideNav-itemLink  ">HTML Code</a>
                    
                </li>
            
                <li class="spectrum-SideNav-item ">
                    
                    <a href="/pwa-studio/pagebuilder/components/image/" class="spectrum-SideNav-itemLink  ">Image</a>
                    
                </li>
            
                <li class="spectrum-SideNav-item ">
                    
                    <a href="/pwa-studio/pagebuilder/components/map/" class="spectrum-SideNav-itemLink  ">Map</a>
                    
                </li>
            
                <li class="spectrum-SideNav-item ">
                    
                    <a href="/pwa-studio/pagebuilder/components/products/" class="spectrum-SideNav-itemLink  ">Products</a>
                    
                </li>
            
                <li class="spectrum-SideNav-item ">
                    
                    <a href="/pwa-studio/pagebuilder/components/row/" class="spectrum-SideNav-itemLink  ">Row</a>
                    
                </li>
            
                <li class="spectrum-SideNav-item ">
                    
                    <a href="/pwa-studio/pagebuilder/components/slider/" class="spectrum-SideNav-itemLink  ">Slider</a>
                    
                </li>
            
                <li class="spectrum-SideNav-item ">
                    
                    <a href="/pwa-studio/pagebuilder/components/tabs/" class="spectrum-SideNav-itemLink  ">Tabs</a>
                    
                </li>
            
                <li class="spectrum-SideNav-item ">
                    
                    <a href="/pwa-studio/pagebuilder/components/text/" class="spectrum-SideNav-itemLink  ">Text</a>
                    
                </li>
            
                <li class="spectrum-SideNav-item ">
                    
                    <a href="/pwa-studio/pagebuilder/components/video/" class="spectrum-SideNav-itemLink  ">Video</a>
                    
                </li>
            
            </ul>
            
        </li>
    
    </ul>
</div>



    </div>
</aside>
<!-- /sidebar -->


	<section class="content">
		<div class="content-wrap">
			<header class="content-header">
				<!-- page-header -->
<section class="page-intro">
	
	<h1 class="page-title">Add aggregator</h1>

	
	
	<div class="github-links spectrum-ActionGroup--compact ActionGroup--justified"><a class="spectrum-ActionButton spectrum-ActionButton--quiet spectrum-ActionButton--sizeM spectrum-ActionGroup-item github-links"
      href="https://github.com/magento/pwa-studio/tree/develop/pwa-devdocs/src/pagebuilder/custom-components/add-aggregator/index.md" target="_blank">
      <img class="spectrum-Icon spectrum-Icon--sizeS" src="/pwa-studio/assets/i/icons/edit.svg" alt="" />
      <span class="spectrum-ActionButton-label">Edit on GitHub</span>
    </a><a class="spectrum-ActionButton spectrum-ActionButton--quiet spectrum-ActionButton--sizeM spectrum-ActionGroup-item github-links"
      href="https://github.com/magento/pwa-studio/issues/new?title=Feedback on page: /pagebuilder/custom-components/add-aggregator/" target="_blank">
      <img class="spectrum-Icon spectrum-Icon--sizeS" src="/pwa-studio/assets/i/icons/bug.svg" alt="" />
      <span class="spectrum-ActionButton-label">Log an Issue</span>
    </a></div>

  



<!--   

<div class="spectrum-Tags" role="list" aria-label="Tags">
  <div class="spectrum-Tags-item" role="listitem" tabindex="0">
    <img class="spectrum-Avatar" src="img/example-ava.jpg" alt="Avatar">
    <span class="spectrum-Tags-itemLabel">Shantanu</span>
  </div>
</div> -->


  

</section>

			</header>
			<main>
				<p>The purpose of the configuration aggregator (<code class="language-plaintext highlighter-rouge">configAggregator</code>) is to retrieve properties from a content type’s HTML and return those properties as a flat object of <code class="language-plaintext highlighter-rouge">key:values</code>. The framework (specifically the <code class="language-plaintext highlighter-rouge">&lt;ContentTypeFactory /&gt;</code>) then passes this object to your component, where you can assign the properties to your component’s corresponding properties for rendering within a PWA Studio app.</p>

<p><img src="images/AddAggregatorOverview.svg" alt="Aggregator Overview" /></p>

<h2 id="content-type-html">Content type HTML</h2>

<p>The key to building out your aggregator is knowing the structure, content, and properties available in your content type’s master format. You can do this the hard way by looking in the database of your Magento instance (specifically, the <code class="language-plaintext highlighter-rouge">content</code> field in the <code class="language-plaintext highlighter-rouge">cms_page</code> and <code class="language-plaintext highlighter-rouge">cms_block</code> tables). But there is a better way.</p>

<p><strong>Protip</strong>: Place a <code class="language-plaintext highlighter-rouge">console.log(node)</code> at the top of your <code class="language-plaintext highlighter-rouge">configAggregator</code> function so you can see exactly what your content type’s HTML (the <code class="language-plaintext highlighter-rouge">HTMLElement</code> passed by the framework) looks like. In the <code class="language-plaintext highlighter-rouge">ExampleQuote</code> starter code, you would add it as shown here:</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">export</span> <span class="k">default</span> <span class="p">(</span><span class="nx">node</span><span class="p">,</span> <span class="nx">props</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">node</span><span class="p">);</span>
    <span class="k">return</span> <span class="p">{</span>
        <span class="c1">// Retrieve properties from node here</span>
    <span class="p">};</span>
<span class="p">};</span>
</code></pre></div></div>

<p>The console output should look something like this:</p>

<p><img src="images/AggregatorHTMLConsoleOutput.png" alt="Content type HTML" /></p>

<p>The <code class="language-plaintext highlighter-rouge">node</code> (HTMLElement) passed to the aggregator contains only your content type’s HTML from the master format, not the entire master format as you would find in the database.</p>

<h2 id="the-aggregator">The Aggregator</h2>

<p>The interface for a <code class="language-plaintext highlighter-rouge">configAggregator</code> is:</p>

<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">(</span><span class="nx">node</span><span class="p">:</span> <span class="nx">HTMLElement</span><span class="p">,</span> <span class="nx">props</span><span class="p">:</span> <span class="p">{</span><span class="nl">contentType</span><span class="p">:</span> <span class="kr">string</span><span class="p">,</span> <span class="nx">appearance</span><span class="p">:</span> <span class="kr">string</span><span class="p">})</span> <span class="o">=&gt;</span> <span class="p">{[</span><span class="na">key</span><span class="p">:</span> <span class="kr">string</span><span class="p">]:</span> <span class="kr">any</span><span class="p">}</span>
</code></pre></div></div>

<p>To recap, the purpose of your component’s aggregator is to collect (aggregate) properties from your content type’s HTML and return a property object for use in your component. The object you return should contain all the text, html, inline styles, and classes you need to faithfully reproduce your content type as a component in PWA Studio.</p>

<p>Let’s look at our Quote content HTML in detail (color coded for easier analysis) to determine the properties we want to pass to our component:</p>

<p><img src="images/MasterFormatHTML.svg" alt="Master format HTML" /></p>

<p>Here’s what we think we need for our component:</p>

<ul>
  <li>The inline <strong>styles</strong> from the main node</li>
  <li>The <strong>text</strong> content from the <code class="language-plaintext highlighter-rouge">&lt;blockquote&gt;</code> and <code class="language-plaintext highlighter-rouge">author</code> nodes</li>
  <li>The <strong>HTML</strong> content from the <code class="language-plaintext highlighter-rouge">description</code> node</li>
  <li>The CSS <strong>classes</strong> from all three child nodes (<code class="language-plaintext highlighter-rouge">&lt;blockquote&gt;</code>, <code class="language-plaintext highlighter-rouge">author</code>, and <code class="language-plaintext highlighter-rouge">description</code>)</li>
</ul>

<p>To retrieve these properties, you’ll want to use a combination of <a href="https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement">HTMLElement DOM properties</a> along with our <a href="/pwa-studio/pagebuilder/utility-functions/">utility functions</a>, as shown next in the example.</p>

<h3 id="example-aggregator">Example aggregator</h3>

<p>Here is the aggregator we use for the <code class="language-plaintext highlighter-rouge">ExampleQuote</code> component:</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">getAdvanced</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">../../utils</span><span class="dl">'</span><span class="p">;</span>

<span class="k">export</span> <span class="k">default</span> <span class="p">(</span><span class="nx">node</span><span class="p">,</span> <span class="nx">props</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>

    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">node</span><span class="p">);</span>

    <span class="k">return</span> <span class="p">{</span>
        <span class="na">quote</span><span class="p">:</span> <span class="nx">node</span><span class="p">.</span><span class="nx">childNodes</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">textContent</span><span class="p">,</span>
        <span class="na">author</span><span class="p">:</span> <span class="nx">node</span><span class="p">.</span><span class="nx">childNodes</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="nx">textContent</span><span class="p">,</span>
        <span class="na">description</span><span class="p">:</span> <span class="nx">node</span><span class="p">.</span><span class="nx">childNodes</span><span class="p">[</span><span class="mi">2</span><span class="p">].</span><span class="nx">innerHTML</span><span class="p">,</span>
        <span class="p">...</span><span class="nx">getAdvanced</span><span class="p">(</span><span class="nx">node</span><span class="p">)</span>
    <span class="p">};</span>
<span class="p">};</span>
</code></pre></div></div>

<p>First we <code class="language-plaintext highlighter-rouge">import</code> the <a href="/pwa-studio/pagebuilder/utility-functions/">utility functions</a> we want to use. In our case, we know that our Quote content type provides end users with the Advanced form section. So we import the <code class="language-plaintext highlighter-rouge">getAdvanced()</code> function from <code class="language-plaintext highlighter-rouge">utils.js</code>. This function is a wrapper that just runs a number of other utility functions that can be used independently if these values are on different nodes:</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">export</span> <span class="kd">function</span> <span class="nx">getAdvanced</span><span class="p">(</span><span class="nx">node</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">{</span>
        <span class="p">...</span><span class="nx">getPadding</span><span class="p">(</span><span class="nx">node</span><span class="p">),</span>
        <span class="p">...</span><span class="nx">getMargin</span><span class="p">(</span><span class="nx">node</span><span class="p">),</span>
        <span class="p">...</span><span class="nx">getBorder</span><span class="p">(</span><span class="nx">node</span><span class="p">),</span>
        <span class="p">...</span><span class="nx">getTextAlign</span><span class="p">(</span><span class="nx">node</span><span class="p">),</span>
        <span class="p">...</span><span class="nx">getCssClasses</span><span class="p">(</span><span class="nx">node</span><span class="p">),</span>
        <span class="p">...</span><span class="nx">getIsHidden</span><span class="p">(</span><span class="nx">node</span><span class="p">)</span>
    <span class="p">};</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Then we use the <code class="language-plaintext highlighter-rouge">element</code> names from the content type HTML (color coded in green above) as our property key names: <code class="language-plaintext highlighter-rouge">quote</code>, <code class="language-plaintext highlighter-rouge">author</code>, and <code class="language-plaintext highlighter-rouge">description</code>. Naming your properties like this helps to identify where the data in the component comes from.</p>

<p>Next, we use the <code class="language-plaintext highlighter-rouge">textContent</code> and <code class="language-plaintext highlighter-rouge">innerHTML</code> DOM properties to grab the text and html values from the appropriate <code class="language-plaintext highlighter-rouge">childNodes</code>.</p>

<p>Finally, we use the <code class="language-plaintext highlighter-rouge">getAdvanced()</code> utility function to retrieve all the property values from the Advanced section of our content type’s form and use the spread operator <code class="language-plaintext highlighter-rouge">(...)</code> to expand them into the current object.</p>

<p class="bs-callout-info">The Quote content type also has a form section called Background (from the <code class="language-plaintext highlighter-rouge">pagebuilder_base_form_with_background_attributes</code> form). This section of the form allows end users to enter all kinds of background attributes, such as images, colors, positions and so on. If your custom content uses the Background section, you should retrieve the those attributes using the <code class="language-plaintext highlighter-rouge">getBackgroundImages(node)</code> utility function. However, to keep things simple for our component, we decided not to pull these attributes from the HTML.</p>

<h3 id="retrieving-data-from-different-appearances">Retrieving data from different Appearances</h3>

<p>If your content type has different appearances, the HTML for each appearance will also differ. To handle these differences, we provide the <code class="language-plaintext highlighter-rouge">appearance</code> within the <code class="language-plaintext highlighter-rouge">props</code> argument so  you can modify your queries in order to retrieve data from the correct node.</p>

<p>For our Quote content type, we only have one appearance (the default); so we do not need to use it. However, the Row content type has three appearances, so it uses a conditional based on the <code class="language-plaintext highlighter-rouge">props.appearance</code> value to determine the correct node to use, as shown here:</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Targeting appearances in the Row aggregator</span>

<span class="k">export</span> <span class="k">default</span> <span class="p">(</span><span class="nx">node</span><span class="p">,</span> <span class="nx">props</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="c1">// Determine which node holds the data for the appearance</span>
    <span class="kd">const</span> <span class="nx">dataNode</span> <span class="o">=</span>
        <span class="nx">props</span><span class="p">.</span><span class="nx">appearance</span> <span class="o">===</span> <span class="dl">'</span><span class="s1">contained</span><span class="dl">'</span> <span class="p">?</span> <span class="nx">node</span><span class="p">.</span><span class="nx">childNodes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">:</span> <span class="nx">node</span><span class="p">;</span>
    <span class="k">return</span> <span class="p">{</span>
        <span class="na">minHeight</span><span class="p">:</span> <span class="nx">dataNode</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">minHeight</span> <span class="p">?</span> <span class="nx">dataNode</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">minHeight</span> <span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
        <span class="p">...</span>
    <span class="p">};</span>
</code></pre></div></div>

<h2 id="test-the-aggregator">Test the aggregator</h2>

<p>The best way to see the properties returned by your aggregator is using <code class="language-plaintext highlighter-rouge">console.log()</code>. For our Quote aggregator, we can do something like this:</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">getAdvanced</span><span class="p">,</span> <span class="nx">getCssClasses</span><span class="p">,</span> <span class="nx">getBackgroundImages</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">../../utils</span><span class="dl">'</span><span class="p">;</span>

<span class="k">export</span> <span class="k">default</span> <span class="p">(</span><span class="nx">node</span><span class="p">,</span> <span class="nx">props</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">node</span><span class="p">);</span>

    <span class="kd">const</span> <span class="nx">propObject</span> <span class="o">=</span> <span class="p">{</span>
        <span class="na">quote</span><span class="p">:</span> <span class="nx">node</span><span class="p">.</span><span class="nx">childNodes</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">textContent</span><span class="p">,</span>
        <span class="na">author</span><span class="p">:</span> <span class="nx">node</span><span class="p">.</span><span class="nx">childNodes</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="nx">textContent</span><span class="p">,</span>
        <span class="na">description</span><span class="p">:</span> <span class="nx">node</span><span class="p">.</span><span class="nx">childNodes</span><span class="p">[</span><span class="mi">2</span><span class="p">].</span><span class="nx">innerHTML</span><span class="p">,</span>
        <span class="p">...</span><span class="nx">getAdvanced</span><span class="p">(</span><span class="nx">node</span><span class="p">)</span>
    <span class="p">};</span>

    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">propObject</span><span class="p">);</span>
    <span class="k">return</span> <span class="nx">propObject</span><span class="p">;</span>
<span class="p">};</span>
</code></pre></div></div>

<p>Adding <code class="language-plaintext highlighter-rouge">console.log(node)</code> at the beginning of your aggregator function, and at he end (<code class="language-plaintext highlighter-rouge">console.log(propObject)</code>), helps to show you the HTML you receive and the object you return. The property object returned from our aggregator looks like this:</p>

<p><img src="images/AggregatorObjectConsoleOutput.png" alt="Aggregator object console output" /></p>

<p class="bs-callout-info">You will need to know the property <code class="language-plaintext highlighter-rouge">key-values</code> you are returning so that that you can assign them to corresponding properties in your component when you build it out.</p>


			</main>
			<footer class="content-footer">
				

			</footer>
		</div>
		<!-- /.content-wrap -->

		<div class="page-info">

  

</div>


	</section>
	<!-- /.content -->

</div> <!-- /.content-container -->

</div>
<!-- /.main-container -->
</div>
<!-- /#gl-wrapper -->

<!-- footer-->
<div class="page-footer">
  <div class="container">

    <div class="copyright-links">
      <ul class="nav footer-links">
  <li><a href="http://magento.com/legal/terms/privacy/">Privacy Policy</a></li>
  <li><a href="http://magento.com/legal/terms/">Terms of Service</a></li>
  <li><a href="http://magento.com/legal/licensing/">License/Trademark FAQ</a></li>
  <li><a href="https://magentocommeng.slack.com/messages/C71HNKYS2">#pwa Slack channel</a></li>
</ul>
    </div>

		<div class="copyright-date">&copy; 2021 Adobe. All rights reserved.</div>

  </div>
</div>
<!-- / #footer -->


<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/algoliasearch/3/algoliasearch.min.js"></script>
<script src="/pwa-studio/assets/js/app.min.js?ver=16"></script>
<script src="/pwa-studio/assets/js/editions.min.js?ver=16"></script>
<script src="/pwa-studio/assets/js/page-updated.min.js?ver=16"></script>

<script src="/pwa-studio/builds/js/index.bundle.js"></script>

</body>

</html>

